# --- Weights & Biases Sweep Configuration ---

method: bayes
name: Sweep-v5-loss
metric:
  name: val/auc
  goal: maximize

program: train_sweep.py

parameters:
  # --- Tier 1: Core Fine-Tuning Parameters ---
  learning_rate:
    distribution: log_uniform_values
    min: 1.0e-5
    max: 5.0e-4
  weight_decay:
    distribution: log_uniform_values
    min: 1.0e-5
    max: 1.0e-3
  lambda_reg:
    distribution: uniform
    min: 0.5
    max: 5.0
  num_frames_per_video:
    values: [2, 4, 8]

  # --- Tier 2: Fixed Parameters for this Sweep ---
  train_batchSize:
    value: 4  # per video. final calculation will be 32 frames per batch (8 frames/video * 4 videos/batch),
              # if num_frames_per_video is 4, number of videos will be 8, so total frames per batch will be 32
  test_batch_size:
    value: 4
  nEpochs:
    value: 50 # Train long enough, but rely on best validation metric for checkpointing if needed
  optimizer_eps:
    value: 1.0e-8 # Standard default, no need to tune

  # --- Tier 3: Fixed Contextual Parameters (Do Not Change) ---
  seed:
    value: 737
  data_subset_percentage:
    value: 1.0
  num_workers:
    value: 1
  prefetch_factor:
    value: 2
  val_split_ratio:
    value: 0.2
  evaluation_frequency:
    value: 1 # Evaluate every epoch

