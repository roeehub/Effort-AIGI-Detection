# --- config/exploratory_sweep.yaml ---
# A focused 7-run sweep to test key hypotheses about Effort on the DF40 dataset.

method: random  # Use random search within the defined discrete values.
name: Sweep-Effort-Explore-v1
metric:
  name: val/auc  # Or val/eer, depending on your primary metric
  goal: maximize

program: train_sweep.py

parameters:
  # --- Hypothesis 1: Regularization Strength ---
  # The baseline is 1.0. Does more strict enforcement of Effort's constraints help?
  lambda_reg:
    values: [1.0, 2.5, 4.0]

  # --- Hypothesis 2: Residual Capacity ---
  # The baseline is 1023 (k=1). Does DF40 need more trainable dimensions?
  # k = 1024 - rank. k=1, k=5, k=10
  rank:
    values: [1023, 1019, 1014]

  # --- Hypothesis 3: Data Sampling Strategy ---
  # Is it better to see frames randomly, or grouped by video?
  dataloader_strategy:
    values: ["frame_level"]

  # --- Core Hyperparameters (mostly fixed) ---
  # Keep LR tight around the known good value.
  learning_rate:
    distribution: log_uniform_values
    min: 8.0e-5
    max: 2.0e-4
  # This is a critical parameter from the paper. Do NOT sweep it in this initial exploration.
  weight_decay:
    value: 0.05
  optimizer_eps:
    value: 1.0e-8

  # --- Training Schedule ---
  # Shorter run for faster results in this exploratory sweep.
  nEpochs:
    value: 10
  early_stopping_enabled:
    value: true
  early_stopping_patience:
    value: 3 # Slightly more aggressive for a shorter sweep
  early_stopping_min_delta:
    value: 0.001

  # --- Data & Dataloader Parameters (Fixed) ---
  frames_per_batch:
    value: 64
  videos_per_batch:
    value: 8
  frames_per_video:
    value: 8

  # --- Fixed Context ---
  test_batch_size:
    value: 16
  val_split_ratio:
    value: 0.1
  evaluation_frequency:
    value: 1
  seed:
    value: 737
  data_subset_percentage:
    value: 1.0
  num_workers:
    value: 2
  prefetch_factor:
    value: 2
  load_base_checkpoint:
    value: false