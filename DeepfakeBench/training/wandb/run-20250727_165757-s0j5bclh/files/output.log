We are in Before: /home/roee/repos/Effort-AIGI-Detection/DeepfakeBench/training
We are in: /home/roee/repos/Effort-AIGI-Detection/DeepfakeBench
The Logger is in:  /home/roee/repos/Effort-AIGI-Detection/DeepfakeBench
2025-07-27 16:57:58,363 - INFO - Save log to ./logs/effort_2025-07-27-16-57-58
2025-07-27 16:57:58,364 - INFO - --------------- Configuration ---------------
2025-07-27 16:57:58,364 - INFO - Parameters:
log_dir: ./logs
pretrained: no need to provide this for the effort model
model_name: effort
backbone_name: vit
backbone_config: {'mode': 'original', 'num_classes': 2, 'inc': 3, 'dropout': False}
all_dataset: ['FaceForensics++', 'FF-F2F', 'FF-DF', 'FF-FS', 'FF-NT', 'FaceShifter', 'DeepFakeDetection', 'Celeb-DF-v1', 'Celeb-DF-v2', 'DFDCP', 'DFDC', 'DeeperForensics-1.0', 'UADFV']
train_dataset: ['DF40']
test_dataset: ['DF40']
compression: c23
train_batchSize: 64
test_batchSize: 32
workers: 8
frame_num: {'train': 8, 'test': 8}
resolution: 224
with_mask: False
with_landmark: False
use_data_augmentation: True
data_aug: {'flip_prob': 0.5, 'rotate_prob': 0.5, 'rotate_limit': [-10, 10], 'blur_prob': 0.5, 'blur_limit': [3, 7], 'brightness_prob': 0.5, 'brightness_limit': [-0.1, 0.1], 'contrast_limit': [-0.1, 0.1], 'quality_lower': 40, 'quality_upper': 100}
mean: [0.48145466, 0.4578275, 0.40821073]
std: [0.26862954, 0.26130258, 0.27577711]
optimizer: {'type': 'adam', 'adam': {'lr': 0.0002, 'beta1': 0.9, 'beta2': 0.999, 'eps': 1e-08, 'weight_decay': 0.0005, 'amsgrad': False}, 'sgd': {'lr': 0.0002, 'momentum': 0.9, 'weight_decay': 0.0005}}
lr_scheduler: None
nEpochs: 10
start_epoch: 0
save_epoch: 1
rec_iter: 100
logdir: ./logs
manualSeed: 1024
save_ckpt: True
save_feat: True
loss_func: cross_entropy
losstype: None
metric_scoring: auc
ngpu: 1
cuda: True
cudnn: True
save_avg: True
mode: train
lmdb: False
dry_run: False
dataset_root_rgb: ./datasets
lmdb_dir: I:\transform_2_lmdb
dataset_json_folder: /Youtu_Pangu_Security_Public/youtu-pangu-public/zhiyuanyan/DeepfakeBenchv2/preprocessing/dataset_json
SWA: False
label_dict: {'DFD_fake': 1, 'DFD_real': 0, 'FF-SH': 1, 'FF-F2F': 1, 'FF-DF': 1, 'FF-FS': 1, 'FF-NT': 1, 'FF-FH': 1, 'FF-real': 0, 'CelebDFv1_real': 0, 'CelebDFv1_fake': 1, 'CelebDFv2_real': 0, 'CelebDFv2_fake': 1, 'DFDCP_Real': 0, 'DFDCP_FakeA': 1, 'DFDCP_FakeB': 1, 'DFDC_Fake': 1, 'DFDC_Real': 0, 'DF_fake': 1, 'DF_real': 0, 'UADFV_Fake': 1, 'UADFV_Real': 0, 'roop_Real': 0, 'roop_Fake': 1, 'FSAll_Fake': 1, 'FSAll_Real': 0, 'FRAll_Fake': 1, 'FRAll_Real': 0, 'EFSAll_Fake': 1, 'EFSAll_Real': 0, 'DF40_train_Fake': 1, 'DF40_train_Real': 0, 'e4s_Fake': 1, 'e4s_Real': 0, 'danet_Fake': 1, 'danet_Real': 0, 'fomm_Fake': 1, 'fomm_Real': 0, 'Collaborative_Diffusion_Fake': 1, 'Collaborative_Diffusion_Real': 0, 'e4e_Fake': 1, 'e4e_Real': 0, 'hyperreenact_Fake': 1, 'hyperreenact_Real': 0, 'MRAA_Fake': 1, 'MRAA_Real': 0, 'one_shot_free_Fake': 1, 'one_shot_free_Real': 0, 'pirender_Fake': 1, 'pirender_Real': 0, 'tpsm_Fake': 1, 'tpsm_Real': 0, 'facedancer_Fake': 1, 'facedancer_Real': 0, 'facevid2vid_Fake': 1, 'facevid2vid_Real': 0, 'mcnet_Fake': 1, 'mcnet_Real': 0, 'mraa_Fake': 1, 'mraa_Real': 0, 'fsgan_Fake': 1, 'fsgan_Real': 0, 'lia_Fake': 1, 'lia_Real': 0, 'inswap_Fake': 1, 'inswap_Real': 0, 'simswap_Fake': 1, 'simswap_Real': 0, 'sadtalker_Fake': 1, 'sadtalker_Real': 0, 'wav2lip_Fake': 1, 'wav2lip_Real': 0, 'uniface_Fake': 1, 'uniface_Real': 0, 'blendface_Fake': 1, 'blendface_Real': 0, 'mobileswap_Fake': 1, 'mobileswap_Real': 0, 'faceswap_Fake': 1, 'faceswap_Real': 0, 'dalle2_face_Fake': 1, 'dalle2_face_Real': 0, 'MidJourney_Fake': 1, 'MidJourney_Real': 0, 'heygen_Fake': 1, 'heygen_Real': 0, 'whichisreal_Fake': 1, 'whichisreal_Real': 0, 'StyleGAN2_Fake': 1, 'StyleGAN2_Real': 0, 'StyleGAN3_Fake': 1, 'StyleGAN3_Real': 0, 'StyleGANXL_Fake': 1, 'StyleGANXL_Real': 0, 'ddim_Fake': 1, 'ddim_Real': 0, 'DiT_Fake': 1, 'DiT_Real': 0, 'pixart_Fake': 1, 'pixart_Real': 0, 'SiT_Fake': 1, 'SiT_Real': 0, 'sd1.5_Fake': 1, 'sd1.5_Real': 0, 'sd2.1_Fake': 1, 'sd2.1_Real': 0, 'VQGAN_Fake': 1, 'VQGAN_Real': 0, 'rddm_Fake': 1, 'rddm_Real': 0, 'stargan_Fake': 1, 'stargan_Real': 0, 'starganv2_Fake': 1, 'starganv2_Real': 0, 'styleclip_Fake': 1, 'styleclip_Real': 0, 'deepfacelab_Fake': 1, 'deepfacelab_Real': 0, 'CollabDiff_Fake': 1, 'CollabDiff_Real': 0, 'adm_Fake': 1, 'adm_Real': 0, 'biggan_Fake': 2, 'biggan_Real': 0, 'glide_Fake': 3, 'glide_Real': 0, 'midjourney_Fake': 4, 'midjourney_Real': 0, 'sdv4_Fake': 5, 'sdv4_Real': 0, 'sdv5_Fake': 6, 'sdv5_Real': 0, 'vqdm_Fake': 7, 'vqdm_Real': 0, 'wukong_Fake': 8, 'wukong_Real': 0, 'GPA_fake': 1, 'GPA_real': 0, 'Chameleon_Fake': 1, 'Chameleon_Real': 0}
eps: 7.507177888500223e-06
lr: 0.00881639863912746
weight_decay: 0.001
local_rank: 0
ddp: False
Listing frame objects on GCS (first run – may take a minute)…
Loading cached file paths from '/home/roee/repos/Effort-AIGI-Detection/partial_manifest.json'...
Found 33,540 frame files – caching manifest
[WARN] excluding all videos from method 'hyperreenact'
Discovered 16,522 videos across 32 methods
Subset active (5 %) → 812 videos
Split complete ▶ train 730 | val 82

/home/roee/repos/Effort-AIGI-Detection/effortvenv/lib/python3.10/site-packages/torch/utils/data/datapipes/utils/common.py:22: UserWarning: Lambda function is not supported for pickle, please use regular python function or functools.partial instead.
  warnings.warn(
Training on methods in this order: ['tpsm', 'fomm', 'lia', 'sadtalker', 'wav2lip']...

--- Example: Method-Aware BALANCED Training Loop ---
/home/roee/repos/Effort-AIGI-Detection/effortvenv/lib/python3.10/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
The CLIP is in:  /home/roee/repos/Effort-AIGI-Detection/DeepfakeBench
2025-07-27 16:58:32,839 - INFO - Model found in ./training/weights/effort_clip_L14_trainOn_FaceForensic.pth
2025-07-27 16:58:32,844 - INFO - ===> Epoch[0] start!
2025-07-27 16:58:32,846 - INFO - data_dict saved to ./logs/effort_2025-07-27-16-55-39/train/DF40/data_dict_train.pickle
EPOCH: 1:   0%|                                                                                                                                                              | 0/3 [00:00<?, ?it/s]/home/roee/repos/Effort-AIGI-Detection/effortvenv/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:990: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
2025-07-27 16:58:51,067 - INFO - Iter: 0    training-loss, overall: 0.3167727589607239    training-loss, real_loss: 0.0    training-loss, fake_loss: 0.3167727589607239
2025-07-27 16:58:51,067 - INFO - Iter: 0    training-metric, acc: 1.0    training-metric, auc: not calculated    training-metric, eer: not calculated    training-metric, ap: 1.0
2025-07-27 16:58:51,068 - INFO - ===> Test start!
2025-07-27 16:58:51,070 - INFO - data_dict saved to ./logs/effort_2025-07-27-16-55-39/test/DF40/data_dict_test.pickle
all input arrays must have the same shape
2025-07-27 17:04:53,260 - INFO - dataset: DF40    step: 0    testing-loss, overall: 0.31017714738845825    testing-loss, real_loss: 3.812735080718994    testing-loss, fake_loss: 5.3600331739289686e-05
2025-07-27 17:04:53,268 - INFO - dataset: DF40    step: 0    testing-metric, acc: 0.96875    testing-metric, auc: 0.7948387096774193    testing-metric, eer: 0.4    testing-metric, ap: 0.9917115167364784    testing-metric, acc_real:1.0; acc_fake:0.967741935483871
2025-07-27 17:05:04,542 - INFO - dataset: avg    step: 0    testing-metric, acc: 0.96875    testing-metric, auc: 0.7948387096774193    testing-metric, eer: 0.4    testing-metric, ap: 0.9917115167364784    testing-metric, video_auc: 0.0
2025-07-27 17:05:04,542 - INFO - ===> Test Done!
EPOCH: 1:  33%|█████████████████████████████████████████████████▋                                                                                                   | 1/3 [06:31<13:03, 391.69s/it]/home/roee/repos/Effort-AIGI-Detection/effortvenv/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:990: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
2025-07-27 17:05:21,921 - INFO - ===> Test start!
2025-07-27 17:05:21,924 - INFO - data_dict saved to ./logs/effort_2025-07-27-16-55-39/test/DF40/data_dict_test.pickle
all input arrays must have the same shape
2025-07-27 17:10:18,153 - INFO - dataset: DF40    step: 1    testing-loss, overall: 0.9015569090843201    testing-loss, real_loss: 11.381247520446777    testing-loss, fake_loss: 2.4910573301895056e-06
2025-07-27 17:10:18,153 - INFO - dataset: DF40    step: 1    testing-metric, acc: 0.9375    testing-metric, auc: 0.7686666666666666    testing-metric, eer: 0.4    testing-metric, ap: 0.9747127622829742    testing-metric, acc_real:1.0; acc_fake:0.9333333333333333
2025-07-27 17:10:18,153 - INFO - dataset: avg    step: 1    testing-metric, acc: 0.9375    testing-metric, auc: 0.7686666666666666    testing-metric, eer: 0.4    testing-metric, ap: 0.9747127622829742    testing-metric, video_auc: 0.0
2025-07-27 17:10:18,154 - INFO - ===> Test Done!
EPOCH: 1:  67%|███████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 2/3 [11:45<05:45, 345.76s/it]/home/roee/repos/Effort-AIGI-Detection/effortvenv/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:990: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
2025-07-27 17:10:34,697 - INFO - ===> Test start!
2025-07-27 17:10:34,699 - INFO - data_dict saved to ./logs/effort_2025-07-27-16-55-39/test/DF40/data_dict_test.pickle
all input arrays must have the same shape
2025-07-27 17:15:52,505 - INFO - dataset: DF40    step: 2    testing-loss, overall: 2.356842517852783    testing-loss, real_loss: 17.974925994873047    testing-loss, fake_loss: 8.069548584899167e-09
2025-07-27 17:15:52,506 - INFO - dataset: DF40    step: 2    testing-metric, acc: 0.86875    testing-metric, auc: 0.6080849606029463    testing-metric, eer: 0.7619047619047619    testing-metric, ap: 0.8943231820845704    testing-metric, acc_real:0.9523809523809523; acc_fake:0.8561151079136691
2025-07-27 17:15:52,506 - INFO - dataset: avg    step: 2    testing-metric, acc: 0.86875    testing-metric, auc: 0.6080849606029463    testing-metric, eer: 0.7619047619047619    testing-metric, ap: 0.8943231820845704    testing-metric, video_auc: 0.0
2025-07-27 17:15:52,507 - INFO - ===> Test Done!
EPOCH: 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [17:19<00:00, 346.55s/it]
2025-07-27 17:15:52,511 - INFO - ===> Epoch[0] end with testing avg auc: 0.7948387096774193!
2025-07-27 17:15:52,513 - INFO - ===> Epoch[1] start!
2025-07-27 17:15:52,515 - INFO - data_dict saved to ./logs/effort_2025-07-27-16-55-39/train/DF40/data_dict_train.pickle
EPOCH: 2:   0%|                                                                                                                                                              | 0/4 [00:00<?, ?it/s]/home/roee/repos/Effort-AIGI-Detection/effortvenv/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:990: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
2025-07-27 17:16:12,818 - INFO - Iter: 4    training-loss, overall: 0.0    training-loss, real_loss: 0.0    training-loss, fake_loss: 0.0
2025-07-27 17:16:12,819 - INFO - Iter: 4    training-metric, acc: 1.0    training-metric, auc: not calculated    training-metric, eer: not calculated    training-metric, ap: 1.0
EPOCH: 2:  25%|█████████████████████████████████████▌                                                                                                                | 1/4 [00:20<01:00, 20.30s/it]/home/roee/repos/Effort-AIGI-Detection/effortvenv/lib/python3.10/site-packages/sklearn/metrics/_ranking.py:990: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
2025-07-27 17:16:33,451 - INFO - ===> Test start!
2025-07-27 17:16:33,454 - INFO - data_dict saved to ./logs/effort_2025-07-27-16-55-39/test/DF40/data_dict_test.pickle
[34m[1mwandb[0m: Ctrl + C detected. Stopping sweep.
